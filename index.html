<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Gesture Drawing App (Mock)</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background: #fafafa;
    }
    .setup {
      max-width: 400px;
      margin: 2rem auto;
      padding: 1rem 2rem;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    .setup h2 {
      text-align: center;
    }
    .setup label {
      display: block;
      margin-top: 1rem;
    }
    .setup input[type="text"],
    .setup select,
    .setup input[type="number"] {
      width: 100%;
      padding: 0.5rem;
      margin-top: 0.25rem;
    }
    .fullscreen {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: black;
      display: none;
      justify-content: center;
      align-items: center;
      flex-direction: column;
    }
    .fullscreen img {
      max-width: 100%;
      max-height: 100%;
    }
    .session-controls {
      position: absolute;
      top: 1rem;
      right: 1rem;
      display: flex;
      gap: 1rem;
    }
    .session-controls button {
      font-size: 1.2rem;
      padding: 0.5rem;
    }
    .timer {
      position: absolute;
      top: 1rem;
      left: 1rem;
      color: white;
      font-size: 2rem;
    }
    #breakNextLabel {
      position: absolute;
      top: 1rem;
      left: 50%;
      transform: translateX(-50%);
      color: gray;
      font-size: 1.5rem;
      display: none;
    }
  </style>
  <audio id="bellSound" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg" preload="auto"></audio>
</head>
<body>

<!-- Break Screen -->
<div class="fullscreen" id="breakScreen" style="background:#111; color:white;">
  <div style="font-size:2rem;">Break Time</div>
  <div id="breakTimer" style="font-size:3rem; margin-top:1rem;">05:00</div>
  <button onclick="skipBreak()" style="margin-top:2rem; padding:1rem 2rem; font-size:1.2rem;">Skip Break</button>
</div>

<!-- Setup Panel -->
<div class="setup" id="setup">
  <h2>Start Drawing Session</h2>

<label>Image Source:</label>
<label><input type="radio" name="pinterestSource" value="board" checked> Paste Board URL(s)</label>
<label><input type="radio" name="pinterestSource" value="user"> Use Pinterest Username</label>


<div id="boardUrlSection" style="margin-top: 1rem;">
  <label>Board URL(s) (comma-separated):</label>
  <input type="text" id="boardUrls" placeholder="https://www.pinterest.com/user/board1, https://..." />
</div>

<div id="userBoardSection" style="margin-top: 1rem; display: none;">
  <label>Pinterest Username:</label>
  <input type="text" id="pinterestUsername" placeholder="e.g. penumbrialhexandroga" />
  <button type="button" onclick="loadUserBoards()">Load Boards</button>

  <label style="margin-top: 0.5rem;">Choose Board(s):</label>
  <select id="userBoards" multiple style="width: 100%; padding: 0.5rem;"></select>
</div>


  <label>Pinterest Board:</label>
  <select id="board">
  <option value="action poses">action poses</option>
  <option value="architecture">architecture</option>
  <option value="birds">birds</option>
  <option value="environments">environments</option>
  <option value="fashion">fashion</option>
  <option value="felines">felines</option>
  <option value="fish">fish</option>
  <option value="hands and extremities">hands and extremities</option>
  <option value="insects">insects</option>
  <option value="mammals">mammals</option>
  <option value="misc. poses">misc. poses</option>
  <option value="portrait">portrait</option>
  <option value="primates">primates</option>
  <option value="statuary">statuary</option>
  <option value="vehilcles">vehilcles</option>
</select>


  <label>Session Type:</label>
  <label><input type="radio" name="mode" value="standard" checked> Standard</label>
  <label><input type="radio" name="mode" value="class"> Class</label>

<div id="classSettings" style="display: none; margin-top: 1rem;">
  <label><input type="checkbox" id="customClassToggle"> Customize Class</label>

  <div id="classPhases">
    <!-- Default steps -->
 <div class="class-phase">
    <input type="number" class="phase-count" value="5" style="width: 3rem;" /> images for
    <input type="number" class="phase-minutes" value="0" style="width: 3rem;" /> min
    <input type="number" class="phase-seconds" value="10" style="width: 3rem;" /> sec
    <label><input type="checkbox" class="phase-break" /> break</label>
  </div>
</div>

  <div id="customControls" style="display: none; margin-top: 0.5rem;">
    <button type="button" onclick="addClassPhase()">Add Phase</button>
  </div>
</div>

<div id="limitSection">
  <label>Session Limit:</label>
  <label><input type="radio" name="limit" value="count" checked> Number of images</label>
<div id="limitCountOptions" style="display: block; margin-top: 0.5rem;">
  <input type="number" id="limitCountValue" value="10" />
</div>
  <label><input type="radio" name="limit" value="time"> Stop at time (minutes)</label>
  <label><input type="radio" name="limit" value="endless"> Endless</label>

  <div id="limitTimeOptions" style="display: none; margin-top: 0.5rem;">
    <input type="number" id="limitValue" value="10" />
    <label><input type="checkbox" id="strictTime"> Stop exactly at time</label>
  </div>
</div>

<div id="standardOptions">
  <label>Duration per Image:</label>
<div style="display: flex; gap: 1rem; margin-top: 0.25rem;">
  <div style="flex: 1;">
    <input type="number" id="durationMin" value="0" placeholder="Minutes" />
  </div>
  <div style="flex: 1;">
    <input type="number" id="durationSec" value="30" placeholder="Seconds" />
  </div>
</div>


  <label>Bell Times (seconds, comma-separated):</label>
  <input type="text" id="bellTimes" value="60,10,5" />

  <label><input type="checkbox" id="breaks" checked> Enable breaks</label>
  <label>Break After (minutes):</label>
  <input type="number" id="breakAfter" value="20" />
  <label>Break Duration (minutes):</label>
  <input type="number" id="breakDuration" value="5" />
</div>

  <button onclick="startSession()">Start Drawing</button>
</div>

<!-- Image Viewer -->
<div class="fullscreen" id="viewer">
<div class="timer" id="imageTimer">00:00</div>
<div class="timer" id="sessionTimer" style="top: 3.5rem;">00:00</div>
<div style="position: absolute; bottom: 1rem; left: 1rem;">
  <button onclick="toggleImageTimer()">Toggle Image Timer</button>
  <button onclick="toggleSessionTimer()">Toggle Session Timer</button>
</div>
  <div id="breakNextLabel">Break next</div>
  <div class="session-controls">
    <button onclick="prevImage()">‚èÆÔ∏è</button>
    <button onclick="togglePause()" id="pauseBtn">‚è∏Ô∏è</button>
    <button onclick="nextImage()">‚è≠Ô∏è</button>
    <button onclick="endSession()">‚èπÔ∏è</button>
  </div>
  <img id="currentImage" src="" />
</div>


<script>
const mockBoards = {
  "environments": [
    "mock_boards/environments board/1. .jpg",
    "mock_boards/environments board/10. .jpg",
    "mock_boards/environments board/11. .jpg",
    "mock_boards/environments board/12. .jpg",
    "mock_boards/environments board/13. .jpg",
    "mock_boards/environments board/14. Discover Australia's.png",
    "mock_boards/environments board/15. .jpg",
    "mock_boards/environments board/2. .jpg",
    "mock_boards/environments board/3. .jpg",
    "mock_boards/environments board/4. .jpg",
    "mock_boards/environments board/5. .png",
    "mock_boards/environments board/6. .jpg",
    "mock_boards/environments board/7. Discover Australia's.png",
    "mock_boards/environments board/8. .jpg",
    "mock_boards/environments board/9. .jpg"
  ],
  "medievalfantasy weapons": [
    "mock_boards/medieval!fantasy weapons board/1. Bow tool sling.jpg",
    "mock_boards/medieval!fantasy weapons board/10. .jpg",
    "mock_boards/medieval!fantasy weapons board/11. Highly decorated.jpg",
    "mock_boards/medieval!fantasy weapons board/12. Weapons  Morning.jpg",
    "mock_boards/medieval!fantasy weapons board/13. .jpg",
    "mock_boards/medieval!fantasy weapons board/14. Silver work.png",
    "mock_boards/medieval!fantasy weapons board/15. .jpg",
    "mock_boards/medieval!fantasy weapons board/2. .jpg",
    "mock_boards/medieval!fantasy weapons board/3. .jpg",
    "mock_boards/medieval!fantasy weapons board/4. .jpg",
    "mock_boards/medieval!fantasy weapons board/5. .jpg",
    "mock_boards/medieval!fantasy weapons board/6. .jpg",
    "mock_boards/medieval!fantasy weapons board/7. .jpg",
    "mock_boards/medieval!fantasy weapons board/8. .jpg",
    "mock_boards/medieval!fantasy weapons board/9. .jpg"
  ],
  "fashion": [
    "mock_boards/fashion board/1. .png",
    "mock_boards/fashion board/10. .jpg",
    "mock_boards/fashion board/11. .jpg",
    "mock_boards/fashion board/12. .jpg",
    "mock_boards/fashion board/13. On location,.jpg",
    "mock_boards/fashion board/14. .jpg",
    "mock_boards/fashion board/15. .png",
    "mock_boards/fashion board/2. .jpg",
    "mock_boards/fashion board/3. .jpg",
    "mock_boards/fashion board/4. .jpg",
    "mock_boards/fashion board/5. .jpg",
    "mock_boards/fashion board/6. .jpg",
    "mock_boards/fashion board/7. .jpg",
    "mock_boards/fashion board/8. .jpg",
    "mock_boards/fashion board/9. .png"
  ],
  "mushrooms plants and flowers": [
    "mock_boards/mushrooms, plants and flowers board/1. .jpg",
    "mock_boards/mushrooms, plants and flowers board/10. untitled-5.jpg.jpg",
    "mock_boards/mushrooms, plants and flowers board/11. .png",
    "mock_boards/mushrooms, plants and flowers board/12. .jpg",
    "mock_boards/mushrooms, plants and flowers board/13. .png",
    "mock_boards/mushrooms, plants and flowers board/14. Red and.jpg",
    "mock_boards/mushrooms, plants and flowers board/15. .jpg",
    "mock_boards/mushrooms, plants and flowers board/2. .jpg",
    "mock_boards/mushrooms, plants and flowers board/3. .jpg",
    "mock_boards/mushrooms, plants and flowers board/4. .jpg",
    "mock_boards/mushrooms, plants and flowers board/5. .jpg",
    "mock_boards/mushrooms, plants and flowers board/6. Big Bang.jpg",
    "mock_boards/mushrooms, plants and flowers board/7. .jpg",
    "mock_boards/mushrooms, plants and flowers board/8. This is.jpg",
    "mock_boards/mushrooms, plants and flowers board/9. .jpg"
  ],
  "trees": [
    "mock_boards/trees board/1. .jpg",
    "mock_boards/trees board/10. .jpg",
    "mock_boards/trees board/11. .png",
    "mock_boards/trees board/12. How to.jpg",
    "mock_boards/trees board/13. .jpg",
    "mock_boards/trees board/14. .jpg",
    "mock_boards/trees board/15. .jpg",
    "mock_boards/trees board/2. .jpg",
    "mock_boards/trees board/3. .jpg",
    "mock_boards/trees board/4. .jpg",
    "mock_boards/trees board/5. .jpg",
    "mock_boards/trees board/6. .jpg",
    "mock_boards/trees board/7. .jpg",
    "mock_boards/trees board/8. .jpg",
    "mock_boards/trees board/9. .jpg"
  ],
  "caninecanidae": [
    "mock_boards/canine!canidae board/1. .jpg",
    "mock_boards/canine!canidae board/10. Saluki Welpen.jpg",
    "mock_boards/canine!canidae board/11. .jpg",
    "mock_boards/canine!canidae board/12. Spanish Sighthound.jpg",
    "mock_boards/canine!canidae board/13. borzoi.png",
    "mock_boards/canine!canidae board/14. .png",
    "mock_boards/canine!canidae board/15. .jpg",
    "mock_boards/canine!canidae board/2. .jpg",
    "mock_boards/canine!canidae board/3. .jpg",
    "mock_boards/canine!canidae board/4. .jpg",
    "mock_boards/canine!canidae board/5. .jpg",
    "mock_boards/canine!canidae board/6. .jpg",
    "mock_boards/canine!canidae board/7. Tangkhul Hui.jpg",
    "mock_boards/canine!canidae board/8. Cirneco Dell'Etna-.jpg",
    "mock_boards/canine!canidae board/9. Dog.jpg"
  ],
  "sea animals": [
    "mock_boards/sea animals board/1. .jpg",
    "mock_boards/sea animals board/10. Decorator crabs.png",
    "mock_boards/sea animals board/11. .jpg",
    "mock_boards/sea animals board/12. PixieWinks.jpg",
    "mock_boards/sea animals board/13. Giant box.png",
    "mock_boards/sea animals board/14. .jpg",
    "mock_boards/sea animals board/15. New ‚ÄòGalaxy‚Äô.jpg",
    "mock_boards/sea animals board/2. .jpg",
    "mock_boards/sea animals board/3. It's Dive.jpg",
    "mock_boards/sea animals board/4. Come brighten.jpg",
    "mock_boards/sea animals board/5. .jpg",
    "mock_boards/sea animals board/6. .jpg",
    "mock_boards/sea animals board/7. .jpg",
    "mock_boards/sea animals board/8. üî• East.jpg",
    "mock_boards/sea animals board/9. Spiny monster.jpg"
  ],
  "ungulates": [
    "mock_boards/ungulates board/1. .png",
    "mock_boards/ungulates board/10. .jpg",
    "mock_boards/ungulates board/11. Sichuan Takin.jpg",
    "mock_boards/ungulates board/12. .jpg",
    "mock_boards/ungulates board/13. –ß–µ—Ä–Ω–∞—è –∞–Ω—Ç–∏–ª–æ–ø–∞.jpg",
    "mock_boards/ungulates board/14. .jpg",
    "mock_boards/ungulates board/15. Scythian horse.jpg",
    "mock_boards/ungulates board/2. .jpg",
    "mock_boards/ungulates board/3. .jpg",
    "mock_boards/ungulates board/4. Bull Okapi.jpg",
    "mock_boards/ungulates board/5. Jentink‚Äôs Duiker.jpg",
    "mock_boards/ungulates board/6. Hemitragus jemlahicus.jpg",
    "mock_boards/ungulates board/7. .jpg",
    "mock_boards/ungulates board/8. Saiga Antelope.jpg",
    "mock_boards/ungulates board/9. Kafue Lechwe.jpg"
  ],
  "mustelidsrodentiamarsupials": [
    "mock_boards/mustelids!rodentia!marsupials board/1. Lumholtz‚Äôs Tree.jpg",
    "mock_boards/mustelids!rodentia!marsupials board/10. The Finnish.jpg",
    "mock_boards/mustelids!rodentia!marsupials board/11. Kowari (Dasyuroides.png",
    "mock_boards/mustelids!rodentia!marsupials board/12. I like.png",
    "mock_boards/mustelids!rodentia!marsupials board/13. Stoat.jpg",
    "mock_boards/mustelids!rodentia!marsupials board/14. Magical Nature.jpg",
    "mock_boards/mustelids!rodentia!marsupials board/15. üî• European.png",
    "mock_boards/mustelids!rodentia!marsupials board/2. .jpg",
    "mock_boards/mustelids!rodentia!marsupials board/3. .jpg",
    "mock_boards/mustelids!rodentia!marsupials board/4. .jpg",
    "mock_boards/mustelids!rodentia!marsupials board/5. .jpg",
    "mock_boards/mustelids!rodentia!marsupials board/6. .jpg",
    "mock_boards/mustelids!rodentia!marsupials board/7. .jpg",
    "mock_boards/mustelids!rodentia!marsupials board/8. Ÿè.jpg",
    "mock_boards/mustelids!rodentia!marsupials board/9. .jpg"
  ],
  "mammals": [
    "mock_boards/mammals board/1. .jpg",
    "mock_boards/mammals board/10. Armadillo.jpg",
    "mock_boards/mammals board/11. Tenrecs!.jpg",
    "mock_boards/mammals board/12. Matschie's Tree.jpg",
    "mock_boards/mammals board/13. .jpg",
    "mock_boards/mammals board/14. .png",
    "mock_boards/mammals board/15. I Capture.jpg",
    "mock_boards/mammals board/2. Mara &.jpg",
    "mock_boards/mammals board/3. Patagonian Mara.jpg",
    "mock_boards/mammals board/4. Greater Hog.jpg",
    "mock_boards/mammals board/5. .jpg",
    "mock_boards/mammals board/6. .jpg",
    "mock_boards/mammals board/7. .jpg",
    "mock_boards/mammals board/8. Dingiso Tree.jpg",
    "mock_boards/mammals board/9. .jpg"
  ],
  "reptilesamphibians": [
    "mock_boards/reptiles!amphibians board/1. .jpg",
    "mock_boards/reptiles!amphibians board/10. .jpg",
    "mock_boards/reptiles!amphibians board/11. .jpg",
    "mock_boards/reptiles!amphibians board/12. .jpg",
    "mock_boards/reptiles!amphibians board/13. .jpg",
    "mock_boards/reptiles!amphibians board/14. .jpg",
    "mock_boards/reptiles!amphibians board/15. Duckbill Tree.jpg",
    "mock_boards/reptiles!amphibians board/2. .jpg",
    "mock_boards/reptiles!amphibians board/3. Tuatara.jpg",
    "mock_boards/reptiles!amphibians board/4. .jpg",
    "mock_boards/reptiles!amphibians board/5. Giant Armadillo.jpg",
    "mock_boards/reptiles!amphibians board/6. .jpg",
    "mock_boards/reptiles!amphibians board/7. Bornean Horned.jpg",
    "mock_boards/reptiles!amphibians board/8. .jpg",
    "mock_boards/reptiles!amphibians board/9. .jpg"
  ],
  "statuary": [
    "mock_boards/statuary board/1. .jpg",
    "mock_boards/statuary board/10. Bronze Figures.png",
    "mock_boards/statuary board/11. .jpg",
    "mock_boards/statuary board/12. Attilio Selva.jpg",
    "mock_boards/statuary board/13. .jpg",
    "mock_boards/statuary board/14. .jpg",
    "mock_boards/statuary board/15. Readiness.jpg",
    "mock_boards/statuary board/2. .jpg",
    "mock_boards/statuary board/3. .jpg",
    "mock_boards/statuary board/4. .jpg",
    "mock_boards/statuary board/5. Statue of.jpg",
    "mock_boards/statuary board/6. .jpg",
    "mock_boards/statuary board/7. .jpg",
    "mock_boards/statuary board/8. Joan of.jpg",
    "mock_boards/statuary board/9. .jpg"
  ],
  "fish": [
    "mock_boards/fish board/1. .jpg",
    "mock_boards/fish board/10. Threadfin butterflyfish,.jpg",
    "mock_boards/fish board/11. .jpg",
    "mock_boards/fish board/12. 45 Beautiful.jpg",
    "mock_boards/fish board/13. 9 Amazing.jpg",
    "mock_boards/fish board/14. Picasso Triggerfish.jpg",
    "mock_boards/fish board/15. Passer Angelfish.jpg",
    "mock_boards/fish board/2. .jpg",
    "mock_boards/fish board/3. .jpg",
    "mock_boards/fish board/4. .jpg",
    "mock_boards/fish board/5. .jpg",
    "mock_boards/fish board/6. Longspine squirrelfish,.jpg",
    "mock_boards/fish board/7. .jpg",
    "mock_boards/fish board/8. Large Ocean.png",
    "mock_boards/fish board/9. .jpg"
  ],
  "portrait": [
    "mock_boards/portrait board/1. City Twists.jpg",
    "mock_boards/portrait board/10. üåô.jpg",
    "mock_boards/portrait board/11. .jpg",
    "mock_boards/portrait board/12. SaÃÑn child,.jpg",
    "mock_boards/portrait board/13. .jpg",
    "mock_boards/portrait board/14. .jpg",
    "mock_boards/portrait board/15. .jpg",
    "mock_boards/portrait board/2. .jpg",
    "mock_boards/portrait board/3. .jpg",
    "mock_boards/portrait board/4. .jpg",
    "mock_boards/portrait board/5. How BeyonceÃÅ.jpg",
    "mock_boards/portrait board/6. .jpg",
    "mock_boards/portrait board/7. .jpg",
    "mock_boards/portrait board/8. .jpg",
    "mock_boards/portrait board/9. .jpg"
  ],
  "vehilcles": [
    "mock_boards/vehilcles board/1. 1962 Mazda.jpg",
    "mock_boards/vehilcles board/10. .jpg",
    "mock_boards/vehilcles board/11. .jpg",
    "mock_boards/vehilcles board/12. .jpg",
    "mock_boards/vehilcles board/13. .jpg",
    "mock_boards/vehilcles board/14. .jpg",
    "mock_boards/vehilcles board/15. Ride the.jpg",
    "mock_boards/vehilcles board/2. .jpg",
    "mock_boards/vehilcles board/3. Comeng at.jpg",
    "mock_boards/vehilcles board/4. .jpg",
    "mock_boards/vehilcles board/5. Shikon¬Æ Embroidered.jpg",
    "mock_boards/vehilcles board/6. .jpg",
    "mock_boards/vehilcles board/7. .jpg",
    "mock_boards/vehilcles board/8. .jpg",
    "mock_boards/vehilcles board/9. .jpg"
  ],
  "birds": [
    "mock_boards/birds board/1. .jpg",
    "mock_boards/birds board/10. Mergansers,mother &.jpg",
    "mock_boards/birds board/11. .jpg",
    "mock_boards/birds board/12. .jpg",
    "mock_boards/birds board/13. .jpg",
    "mock_boards/birds board/14. Comb Duck.jpg",
    "mock_boards/birds board/15. .jpg",
    "mock_boards/birds board/2. .jpg",
    "mock_boards/birds board/3. Vulture.jpg",
    "mock_boards/birds board/4. .jpg",
    "mock_boards/birds board/5. .jpg",
    "mock_boards/birds board/6. .jpg",
    "mock_boards/birds board/7. .jpg",
    "mock_boards/birds board/8. .jpg",
    "mock_boards/birds board/9. .jpg"
  ],
  "felines": [
    "mock_boards/felines board/1. .jpg",
    "mock_boards/felines board/10. .jpg",
    "mock_boards/felines board/11. .jpg",
    "mock_boards/felines board/12. .jpg",
    "mock_boards/felines board/13. .jpg",
    "mock_boards/felines board/14. PaleCoat.jpg",
    "mock_boards/felines board/15. .jpg",
    "mock_boards/felines board/2. .jpg",
    "mock_boards/felines board/3. Peterbald Cat.jpg",
    "mock_boards/felines board/4. .jpg",
    "mock_boards/felines board/5. .jpg",
    "mock_boards/felines board/6. .jpg",
    "mock_boards/felines board/7. .jpg",
    "mock_boards/felines board/8. LeapingStar.jpg",
    "mock_boards/felines board/9. .jpg"
  ],
  "primates": [
    "mock_boards/primates board/1. Hanuman Langur.jpg",
    "mock_boards/primates board/10. .jpg",
    "mock_boards/primates board/11. Hanuman Langur.jpg",
    "mock_boards/primates board/12. These Intense.jpg",
    "mock_boards/primates board/13. The independent.jpg",
    "mock_boards/primates board/14. .jpg",
    "mock_boards/primates board/15. .jpg",
    "mock_boards/primates board/2. .jpg",
    "mock_boards/primates board/3. .jpg",
    "mock_boards/primates board/4. Red Ruffed.jpg",
    "mock_boards/primates board/5. .jpg",
    "mock_boards/primates board/6. .jpg",
    "mock_boards/primates board/7. .jpg",
    "mock_boards/primates board/8. .jpg",
    "mock_boards/primates board/9. .jpg"
  ],
  "misc. poses": [
    "mock_boards/misc. poses board/1. .jpg",
    "mock_boards/misc. poses board/10. .jpg",
    "mock_boards/misc. poses board/11. .jpg",
    "mock_boards/misc. poses board/12. Female Models.jpg",
    "mock_boards/misc. poses board/13. .jpg",
    "mock_boards/misc. poses board/14. .jpg",
    "mock_boards/misc. poses board/15. .jpg",
    "mock_boards/misc. poses board/2. üï∏Ô∏è.jpg",
    "mock_boards/misc. poses board/3. .jpg",
    "mock_boards/misc. poses board/4. .jpg",
    "mock_boards/misc. poses board/5. Dynamic Posing.jpg",
    "mock_boards/misc. poses board/6. .jpg",
    "mock_boards/misc. poses board/7. .jpg",
    "mock_boards/misc. poses board/8. How To.jpg",
    "mock_boards/misc. poses board/9. .jpg"
  ],
  "action poses": [
    "mock_boards/action poses board/1. PHOTOS  Rafael.jpg",
    "mock_boards/action poses board/10. .jpg",
    "mock_boards/action poses board/11. .jpg",
    "mock_boards/action poses board/12. .jpg",
    "mock_boards/action poses board/13. .jpg",
    "mock_boards/action poses board/14. .jpg",
    "mock_boards/action poses board/15. Life in.png",
    "mock_boards/action poses board/2. .jpg",
    "mock_boards/action poses board/3. .jpg",
    "mock_boards/action poses board/4. .jpg",
    "mock_boards/action poses board/5. Will Ospreay.jpg",
    "mock_boards/action poses board/6. .jpg",
    "mock_boards/action poses board/7. X.jpg",
    "mock_boards/action poses board/8. .jpg",
    "mock_boards/action poses board/9. .jpg"
  ],
  "hands and extremities": [
    "mock_boards/hands and extremities board/1. .jpg",
    "mock_boards/hands and extremities board/10. .jpg",
    "mock_boards/hands and extremities board/11. pleasing.jpg",
    "mock_boards/hands and extremities board/12. Premium Photo.jpg",
    "mock_boards/hands and extremities board/13. 'Empty Hands'.jpg",
    "mock_boards/hands and extremities board/14. .jpg",
    "mock_boards/hands and extremities board/15. .jpg",
    "mock_boards/hands and extremities board/2. .jpg",
    "mock_boards/hands and extremities board/3. Show Photos.jpg",
    "mock_boards/hands and extremities board/4. .jpg",
    "mock_boards/hands and extremities board/5. Show Photos.jpg",
    "mock_boards/hands and extremities board/6. .jpg",
    "mock_boards/hands and extremities board/7. .jpg",
    "mock_boards/hands and extremities board/8. .jpg",
    "mock_boards/hands and extremities board/9. .jpg"
  ],
  "insects": [
    "mock_boards/insects board/1. .jpg",
    "mock_boards/insects board/10. fly.jpg",
    "mock_boards/insects board/11. .jpg",
    "mock_boards/insects board/12. anmal.jpg",
    "mock_boards/insects board/13. .jpg",
    "mock_boards/insects board/14. Katydid Nymph.jpg",
    "mock_boards/insects board/15. 19 Creatures.jpg",
    "mock_boards/insects board/2. The Lost.jpg",
    "mock_boards/insects board/3. Emergence.jpg",
    "mock_boards/insects board/4. Acid Picdump.jpg",
    "mock_boards/insects board/5. .jpg",
    "mock_boards/insects board/6. ..microscope.jpg",
    "mock_boards/insects board/7. .jpg",
    "mock_boards/insects board/8. Trilobite beetle.jpg",
    "mock_boards/insects board/9. Perfectly Timed.jpg"
  ]
};


let imageList = [], currentIndex = 0, sessionTimer = null, isPaused = false;
let imageDuration = 30, remaining = 0, elapsedTime = 0;
let limitMode = "count", limitValue = 10, strictTime = false;
let inBreak = false, breakTimeRemaining = 0, breaksTaken = 0;
let breakEnabled = false, breakAfter = 20, breakDuration = 5;
let bellTimes = [], bellFiredThisImage = new Set(), bellFiredThisBreak = new Set();
let sessionMode = "standard";
let classImageSchedule = [];
let imageDisplayIndex = 0; // new tracker for actual images shown (not breaks)
let sessionRemaining = null;
let showImageTimer = true;
let showSessionTimer = true;
let mockBoards = {};

function startSession() {
  const source = document.querySelector('input[name="pinterestSource"]:checked').value;
  let boards = [];

  if (source === "user") {
    const selectedOptions = document.getElementById("userBoards").selectedOptions;
    boards = Array.from(selectedOptions).map(opt => opt.value);
  } else {
    boards = [document.getElementById("board").value];
  }

  sessionMode = document.querySelector("input[name='mode']:checked").value;
  limitMode = document.querySelector("input[name='limit']:checked").value;
  if (limitMode === "time") {
    limitValue = parseInt(document.getElementById("limitValue").value);
  } else if (limitMode === "count") {
    limitValue = parseInt(document.getElementById("limitCountValue").value);
  }
  strictTime = document.getElementById("strictTime").checked;
  bellTimes = document.getElementById("bellTimes").value.split(",").map(n => parseInt(n.trim())).filter(n => !isNaN(n));
  breakEnabled = document.getElementById("breaks").checked;
  breakAfter = parseInt(document.getElementById("breakAfter").value);
  breakDuration = parseInt(document.getElementById("breakDuration").value);

  // Reset state
  elapsedTime = 0;
  breaksTaken = 0;
  inBreak = false;
  bellFiredThisImage.clear();
  bellFiredThisBreak.clear();
  currentIndex = 0;
  imageDisplayIndex = 0;

  // üîÅ Combine all selected boards' images
  imageList = shuffleArray(boards.flatMap(name => mockBoards[name] || []));

  if (sessionMode === "standard") {
    const durationMin = parseInt(document.getElementById("durationMin").value || "0");
    const durationSec = parseInt(document.getElementById("durationSec").value || "0");
    imageDuration = durationMin * 60 + durationSec;
    classImageSchedule = [];
  } else {
    classImageSchedule = [];
    document.querySelectorAll("#classPhases .class-phase").forEach(phase => {
      const isBreak = phase.querySelector(".phase-break").checked;
      const duration = (
        parseInt(phase.querySelector(".phase-minutes").value || "0") * 60 +
        parseInt(phase.querySelector(".phase-seconds").value || "0")
      );
      const count = isBreak ? 1 : parseInt(phase.querySelector(".phase-count").value || "1");

      for (let i = 0; i < count; i++) {
        classImageSchedule.push({ duration, isBreak });
      }
    });
    limitMode = "count";
    limitValue = classImageSchedule.length;
  }

  document.getElementById("setup").style.display = "none";
  document.getElementById("viewer").style.display = "flex";
  showImage();

  if (limitMode === "time") {
    sessionRemaining = limitValue * 60;
  } else if (sessionMode === "class") {
    sessionRemaining = classImageSchedule.reduce((sum, phase) => sum + phase.duration, 0);
  } else {
    sessionRemaining = null;
  }
}

  currentIndex = 0;
imageDisplayIndex = 0;

  if (sessionMode === "standard") {
    const durationMin = parseInt(document.getElementById("durationMin").value || "0");
    const durationSec = parseInt(document.getElementById("durationSec").value || "0");
    imageDuration = durationMin * 60 + durationSec;
    classImageSchedule = [];
  } else {
    classImageSchedule = [];
   document.querySelectorAll("#classPhases .class-phase").forEach(phase => {
  const isBreak = phase.querySelector(".phase-break").checked;
  const duration = (
    parseInt(phase.querySelector(".phase-minutes").value || "0") * 60 +
    parseInt(phase.querySelector(".phase-seconds").value || "0")
  );
  const count = isBreak ? 1 : parseInt(phase.querySelector(".phase-count").value || "1");

  for (let i = 0; i < count; i++) {
    classImageSchedule.push({ duration, isBreak });
  }
});

    limitMode = "count";
    limitValue = classImageSchedule.length;
  }

  document.getElementById("setup").style.display = "none";
  document.getElementById("viewer").style.display = "flex";
  showImage();

if (limitMode === "time") {
  sessionRemaining = limitValue * 60;
} else if (sessionMode === "class") {
  sessionRemaining = classImageSchedule.reduce((sum, phase) => sum + phase.duration, 0);
} else {
  sessionRemaining = null; // No session-wide timer
}
}

 

function shuffleArray(arr) {
  return arr.sort(() => Math.random() - 0.5);
}

function showImage() {
  // End session if we're out of phases
  if (sessionMode === "class" && currentIndex >= classImageSchedule.length) {
    endSession();
    return;
  }

  document.getElementById("breakScreen").style.display = "none";
  document.getElementById("viewer").style.display = "flex";
  document.getElementById("breakNextLabel").style.display = "none";
  bellFiredThisImage.clear();

  const img = document.getElementById("currentImage");

  if (sessionMode === "class") {
    const schedule = classImageSchedule[currentIndex];
    if (schedule.isBreak) {
      startBreak(schedule.duration);
      return;
    }

    remaining = schedule.duration;
    img.src = imageList[imageDisplayIndex % imageList.length];
    imageDisplayIndex++;
  } else {
    remaining = imageDuration;
    img.src = imageList[imageDisplayIndex % imageList.length];
    imageDisplayIndex++;
  }

  updateTimerDisplay();
  runTimer();
}

function updateSessionTimer() {
  const min = Math.floor(sessionRemaining / 60).toString().padStart(2, '0');
  const sec = (sessionRemaining % 60).toString().padStart(2, '0');
  const el = document.getElementById("sessionTimer");
  el.innerText = `${min}:${sec}`;
  el.style.display = showSessionTimer ? "block" : "none";
}

function runTimer() {
  clearInterval(sessionTimer);
  sessionTimer = setInterval(() => {
    if (isPaused) return;

    elapsedTime++
if (sessionRemaining !== null && !inBreak) {
  sessionRemaining--;
  updateSessionTimer();
  if (sessionRemaining <= 0) {
    endSession();
    return;
  }
};

    // ‚úÖ Check if session should end based on strict or flexible time before any other logic
    if (shouldEndSession()) {
      endSession();
      return;
    }

    const timeUntilNextBreak = (breaksTaken + 1) * breakAfter * 60 - elapsedTime;

    if (!inBreak && breakEnabled && timeUntilNextBreak <= imageDuration && remaining === imageDuration) {
      document.getElementById("breakNextLabel").style.display = "block";
    }

    if (!inBreak && breakEnabled && timeUntilNextBreak <= 0) {
      startBreak();
      return;
    }

    if (inBreak) {
      breakTimeRemaining--;
      updateBreakTimer();
      if (bellTimes.includes(breakTimeRemaining) && !bellFiredThisBreak.has(breakTimeRemaining)) {
        document.getElementById("bellSound").play();
        bellFiredThisBreak.add(breakTimeRemaining);
      }
      if (breakTimeRemaining <= 0) endBreak();
      return;
    }

    remaining--;
    updateTimerDisplay();

    if (bellTimes.includes(remaining) && !bellFiredThisImage.has(remaining)) {
      document.getElementById("bellSound").play();
      bellFiredThisImage.add(remaining);
    }

    // ‚úÖ If image time is done, proceed
    if (remaining <= 0) {
      nextImage();
    }
  }, 1000);
}
function updateTimerDisplay() {
  const min = Math.floor(remaining / 60).toString().padStart(2, '0');
  const sec = (remaining % 60).toString().padStart(2, '0');
  document.getElementById("imageTimer").innerText = `${min}:${sec}`;
document.getElementById("imageTimer").style.display = showImageTimer ? "block" : "none";
}

function toggleImageTimer() {
  showImageTimer = !showImageTimer;
  updateTimerDisplay();
}

function toggleSessionTimer() {
  showSessionTimer = !showSessionTimer;
  updateSessionTimer();
}

function updateBreakTimer() {
  const min = Math.floor(breakTimeRemaining / 60).toString().padStart(2, '0');
  const sec = (breakTimeRemaining % 60).toString().padStart(2, '0');
  document.getElementById("breakTimer").innerText = `${min}:${sec}`;
}

function nextImage() {
  currentIndex++;
  showImage();
}

function prevImage() {
  currentIndex = Math.max(0, currentIndex - 1);
  showImage();
}

function togglePause() {
  isPaused = !isPaused;
  document.getElementById("pauseBtn").innerText = isPaused ? "‚ñ∂Ô∏è" : "‚è∏Ô∏è";
}

function endSession() {
  clearInterval(sessionTimer);
  document.getElementById("viewer").style.display = "none";
  document.getElementById("breakScreen").style.display = "none";
  document.getElementById("finishedScreen").style.display = "flex";
}

function shouldEndSession() {
  if (limitMode === "endless") return false;
  if (limitMode === "count") return currentIndex >= limitValue;
  if (limitMode === "time") {
    const totalLimit = limitValue * 60;
    return strictTime ? elapsedTime >= totalLimit : elapsedTime > totalLimit && remaining <= 0;
  }
  return false;
}

function startBreak(customDuration = breakDuration * 60) {
  inBreak = true;
  breaksTaken++;
  bellFiredThisBreak.clear();
  breakTimeRemaining = customDuration;
  document.getElementById("viewer").style.display = "none";
  document.getElementById("breakScreen").style.display = "flex";
  updateBreakTimer();
  runTimer();
}

function endBreak() {
  inBreak = false;
  document.getElementById("breakScreen").style.display = "none";
  currentIndex++; // ‚úÖ Move forward
  showImage();     // ‚úÖ Let showImage decide if next is break or image
}

function skipBreak() {
  endBreak();
}


// Toggle custom class control
document.getElementById("customClassToggle").addEventListener("change", (e) => {
  document.getElementById("customControls").style.display = e.target.checked ? "block" : "none";
});

// Allow users to add new phases dynamically
function addClassPhase() {
  const container = document.getElementById("classPhases");
  const div = document.createElement("div");
  div.className = "class-phase";
  div.innerHTML = `
    <input type="number" class="phase-count" value="1" style="width: 3rem;" /> images for
    <input type="number" class="phase-minutes" value="0" style="width: 3rem;" /> min
    <input type="number" class="phase-seconds" value="30" style="width: 3rem;" /> sec
    <label><input type="checkbox" class="phase-break" /> break</label>
  `;
  container.appendChild(div);
}

// Toggle class settings when session type is selected
document.querySelectorAll('input[name="mode"]').forEach(radio => {
  radio.addEventListener('change', () => {
    const isClass = document.querySelector('input[name="mode"]:checked').value === "class";
    document.getElementById("classSettings").style.display = isClass ? "block" : "none";
    document.getElementById("limitSection").style.display = isClass ? "none" : "block";
    document.getElementById("standardOptions").style.display = isClass ? "none" : "block"; // ‚úÖ Add this
  });
});



window.addEventListener('DOMContentLoaded', () => {
  const isClass = document.querySelector('input[name="mode"]:checked').value === "class";
  document.getElementById("classSettings").style.display = isClass ? "block" : "none";
  document.getElementById("limitSection").style.display = isClass ? "none" : "block";
  document.getElementById("standardOptions").style.display = isClass ? "none" : "block";

  const isTime = document.querySelector('input[name="limit"]:checked').value === "time";
  document.getElementById("limitTimeOptions").style.display = isTime ? "block" : "none";
});

document.querySelectorAll('input[name="pinterestSource"]').forEach(radio => {
  radio.addEventListener('change', () => {
    const source = document.querySelector('input[name="pinterestSource"]:checked').value;
    document.getElementById("boardUrlSection").style.display = source === "board" ? "block" : "none";
    document.getElementById("userBoardSection").style.display = source === "user" ? "block" : "none";
  });
});


document.querySelectorAll('input[name="limit"]').forEach(radio => {
  radio.addEventListener('change', () => {
    const selected = document.querySelector('input[name="limit"]:checked').value;
    document.getElementById("limitTimeOptions").style.display = selected === "time" ? "block" : "none";
    document.getElementById("limitCountOptions").style.display = selected === "count" ? "block" : "none";
  });
});

async function loadUserBoards() {
  const select = document.getElementById("userBoards");
  select.innerHTML = ""; // Clear previous options

  try {
    const response = await fetch("mock_boards/manifest.json");
    if (!response.ok) throw new Error("Failed to fetch manifest");

    const data = await response.json();

    // Update global mockBoards
    mockBoards = data;

    Object.keys(data).forEach(name => {
      const opt = document.createElement("option");
      opt.value = name;
      opt.textContent = name;
      select.appendChild(opt);
    });
  } catch (err) {
    alert("Unable to load mock boards.");
    console.error(err);
  }
}


}


function backToSetup() {
  document.getElementById("finishedScreen").style.display = "none";
  document.getElementById("setup").style.display = "block";
}



</script>

<!-- Session Finished Screen -->
<div class="fullscreen" id="finishedScreen" style="background:#222; color:white;">
  <div style="font-size:2rem;">Session finished! Awesome work! üòÑ</div>
  <button onclick="backToSetup()" style="margin-top:2rem; padding:1rem 2rem; font-size:1.2rem;">Back to Setup</button>
</div>


<script>
  window.addEventListener("DOMContentLoaded", () => {
    function updateSourceVisibility() {
      const source = document.querySelector('input[name="pinterestSource"]:checked').value;
      document.getElementById("boardUrlSection").style.display = source === "board" ? "block" : "none";
      document.getElementById("userBoardSection").style.display = source === "user" ? "block" : "none";
    }

    document.querySelectorAll('input[name="pinterestSource"]').forEach(radio => {
      radio.addEventListener('change', updateSourceVisibility);
    });

    updateSourceVisibility();
  });
</script>

</body>
</html>
